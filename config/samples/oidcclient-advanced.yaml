---
# Example of an OIDC client with advanced settings
apiVersion: security.homelab.io/v1alpha1
kind: OIDCClient
metadata:
  name: internal-service
  namespace: services
spec:
  clientId: internal-service
  clientName: Internal Service
  secretRef:
    name: internal-service-oidc
    key: client_secret
  redirectUris:
    - https://service.internal.example.com/callback
  scopes:
    - openid
    - profile
    - email
    - groups
  extraScopes:
    - nextcloud_userinfo
  # Audience restriction
  audience:
    - internal-api
    - reporting-api
  # Authorization settings
  authorizationPolicy: two_factor
  # Claims policy for custom userinfo scopes
  claimsPolicy: nextcloud_userinfo
  # Pre-configured consent for trusted internal services
  consentMode: pre-configured
  preconfiguredConsentDuration: "720h"  # 30 days
  # Sector identifier URI for pairwise subject identifiers
  sectorIdentifierUri: https://internal.example.com
  # Token endpoint settings
  tokenEndpointAuthMethod: client_secret_basic
  # Access token signing (optional)
  accessTokenSignedResponseAlg: none
